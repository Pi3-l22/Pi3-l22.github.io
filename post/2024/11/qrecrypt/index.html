<!doctype html><html lang=zh-cn><head><script>(function(){const e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)})()</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=author content="LiuChao"><meta name=description content="QREcrypt 是一个基于 Go 语言开发的文件加密和管理工具，提供了安全可靠的文件加密和管理功能。本工具采用现代加密算法，结合双重认证机制，为用户提供了一个安全的文件加密解决方案。"><link rel=icon href=https://blog.pi3.fun/favicon.ico><meta name=keywords content=" study  latex  life  academic "><meta property="og:url" content="https://blog.pi3.fun/post/2024/11/qrecrypt/"><meta property="og:site_name" content="Pi3's Notes"><meta property="og:title" content="QREcrypt - 安全文件加密工具"><meta property="og:description" content="QREcrypt 是一个基于 Go 语言开发的文件加密和管理工具，提供了安全可靠的文件加密和管理功能。本工具采用现代加密算法，结合双重认证机制，为用户提供了一个安全的文件加密解决方案。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-11-22T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-22T00:00:00+00:00"><meta property="article:tag" content="技术"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Fyne"><meta property="article:tag" content="密码学"><meta property="article:tag" content="加密"><link rel=canonical href=https://blog.pi3.fun/post/2024/11/qrecrypt/><meta itemprop=name content="QREcrypt - 安全文件加密工具"><meta itemprop=description content="QREcrypt 是一个基于 Go 语言开发的文件加密和管理工具，提供了安全可靠的文件加密和管理功能。本工具采用现代加密算法，结合双重认证机制，为用户提供了一个安全的文件加密解决方案。"><meta itemprop=datePublished content="2024-11-22T00:00:00+00:00"><meta itemprop=dateModified content="2024-11-22T00:00:00+00:00"><meta itemprop=wordCount content="3403"><meta itemprop=keywords content="技术,Golang,Fyne,密码学,加密"><link media=screen rel=stylesheet href=https://blog.pi3.fun/css/common.css><link media=screen rel=stylesheet href=https://blog.pi3.fun/css/content.css><link media=screen rel=stylesheet href=https://blog.pi3.fun/css/theme.css><link media=screen rel=stylesheet href=https://blog.pi3.fun/css/iconfont/iconfont.css><link rel=stylesheet href=https://blog.pi3.fun/css/syntax/xcode.css data-theme-style=light media="(prefers-color-scheme: light)"><link rel=stylesheet href=https://blog.pi3.fun/css/syntax/catppuccin-mocha.css data-theme-style=dark media="not all"><title>QREcrypt - 安全文件加密工具 - Pi3's Notes</title>
<link rel=stylesheet href=https://blog.pi3.fun/css/single.css><link href=https://lf3-cdn-tos.bytecdntp.com/cdn/expire-100-y/KaTeX/0.15.2/katex.min.css rel=stylesheet><script defer src=https://lf3-cdn-tos.bytecdntp.com/cdn/expire-100-y/KaTeX/0.15.2/katex.min.js></script><script defer src=https://lf3-cdn-tos.bytecdntp.com/cdn/expire-100-y/KaTeX/0.15.2/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],ignoredTags:["script","noscript","style","textarea","pre","code","option"],throwOnError:!1})})</script></head><body><div id=wrapper><header id=header><h1><a href=https://blog.pi3.fun/>Pi3's Notes</a></h1><nav><span class=nav-bar-item><a class=link href=/>文章</a>
</span><span class=nav-bar-item><a class=link href=/post/>归档</a>
</span><span class=nav-bar-item><a class=link href=/about/>关于</a>
</span><span class=nav-bar-item><a class=link href=/links/>友链</a>
</span><span class=nav-bar-item><a class="link theme-toggle" href=javascript:void(0);>黑暗</a></span></nav></header><main id=main class=post><h1>QREcrypt - 安全文件加密工具</h1><div><b>Keywords: </b><a class=link href=https://blog.pi3.fun/tags/%E6%8A%80%E6%9C%AF>#技术</a>
<a class=link href=https://blog.pi3.fun/tags/golang>#Golang</a>
<a class=link href=https://blog.pi3.fun/tags/fyne>#Fyne</a>
<a class=link href=https://blog.pi3.fun/tags/%E5%AF%86%E7%A0%81%E5%AD%A6>#密码学</a>
<a class=link href=https://blog.pi3.fun/tags/%E5%8A%A0%E5%AF%86>#加密</a></div><details><summary><b>Table of Contents</b></summary><div class=toc><nav id=TableOfContents><ul><li><a href=#主要特性>主要特性</a></li><li><a href=#安装说明>安装说明</a></li><li><a href=#使用指南>使用指南</a><ul><li><a href=#用户注册>用户注册</a></li><li><a href=#用户登录>用户登录</a></li><li><a href=#加密设置>加密设置</a></li><li><a href=#文件加密>文件加密</a></li><li><a href=#文件解密>文件解密</a></li><li><a href=#其他功能>其他功能</a></li><li><a href=#安全建议>安全建议</a></li></ul></li><li><a href=#软件原理>软件原理</a><ul><li><a href=#底层数据结构>底层数据结构</a></li><li><a href=#运行流程>运行流程</a></li><li><a href=#安全性说明>安全性说明</a></li></ul></li><li><a href=#常见问题>常见问题</a></li><li><a href=#许可证>许可证</a></li><li><a href=#联系方式>联系方式</a></li></ul></nav></div></details><article class=content><p>QREcrypt 是一个基于 Go 语言开发的文件加密和管理工具，提供了安全可靠的文件加密和管理功能。本工具采用现代加密算法，结合双重认证机制，为用户提供了一个安全的文件加密解决方案。</p><p><img src=https://image.pi3.fun/blog/banner2.png alt=banner2.png></p><h2 id=主要特性>主要特性</h2><ul><li>支持多种高强度加密算法（QChaCha 20、XChaCha 20、ChaCha 20、AES-256 等）</li><li>集成双重认证（2 FA）机制，提供额外的安全保障</li><li>直观的图形用户界面，支持列表和网格两种文件视图模式</li><li>文件完整性验证，确保加密和解密过程的可靠性</li><li>支持文件搜索功能，方便管理大量加密文件</li><li>自动生成强密钥功能，帮助用户创建高强度密码</li></ul><h2 id=安装说明>安装说明</h2><ol><li><a href=http://pi3.fun/qrecrypt/QREcrypt.zip>点击下载最新版本</a></li><li>解压下载的文件</li><li>运行 <code>QREcrypt.exe</code> 可执行文件</li></ol><h2 id=使用指南>使用指南</h2><h3 id=用户注册>用户注册</h3><p><img src=https://image.pi3.fun/blog/image-20241122000320788.png alt=image-20241122000320788></p><ol><li>启动程序，点击<strong class=chinese>注册用户</strong>按钮</li><li>填写以下信息：<ul><li><strong class=chinese>用户名</strong>：设置您的账户名称</li><li><strong class=chinese>主密钥</strong>：用于登录系统的主要密码</li><li><strong class=chinese>副密钥</strong>：用于加密/解密文件的密码</li></ul></li><li>点击<strong class=chinese>生成强密钥</strong>可自动生成安全的随机密码</li><li>点击<strong class=chinese>绑定认证码</strong>，使用 Google Authenticator 等 2 FA 应用扫描显示的二维码</li><li>输入 2 FA 应用显示的 6 位验证码</li><li>点击<strong class=chinese>注册用户</strong>完成注册</li></ol><h3 id=用户登录>用户登录</h3><p><img src=https://image.pi3.fun/blog/image-20241122000256884.png alt=image-20241122000256884></p><ol><li>输入<strong class=chinese>用户名</strong>和主密钥</li><li>输入 2 FA 应用当前显示的 6 位验证码</li><li>点击<strong class=chinese>登录用户</strong></li></ol><h3 id=加密设置>加密设置</h3><p><img src=https://image.pi3.fun/blog/image-20241122000402857.png alt=image-20241122000402857></p><ol><li>点击工具栏的<strong class=chinese>加密设置</strong>按钮</li><li>选择不同的<strong class=chinese>文件加密算法</strong></li><li>选择不同的<strong class=chinese>密钥派生算法</strong></li><li>点击保存按钮</li></ol><h3 id=文件加密>文件加密</h3><p><img src=https://image.pi3.fun/blog/image-20241122000415508.png alt=image-20241122000415508></p><ol><li>点击工具栏的<strong class=chinese>加密文件</strong>按钮</li><li>输入<strong class=chinese>副密钥</strong>进行验证</li><li>选择需要加密的文件</li><li>等待加密完成</li></ol><h3 id=文件解密>文件解密</h3><p><img src=https://image.pi3.fun/blog/image-20241122000429122.png alt=image-20241122000429122></p><ol><li>在文件列表中选择要解密的文件</li><li>点击工具栏的<strong class=chinese>解密文件</strong>按钮</li><li>输入<strong class=chinese>副密钥</strong>进行验证</li><li>选择解密文件的<strong class=chinese>保存位置</strong></li><li>等待解密完成</li></ol><h3 id=其他功能>其他功能</h3><p><img src=https://image.pi3.fun/blog/image-20241122000500951.png alt=image-20241122000500951></p><ul><li><strong class=chinese>帮助</strong>：打开在线帮助文档</li><li><strong class=chinese>网格视图</strong>：以网格形式显示文件</li><li><strong class=chinese>列表视图</strong>：以树形列表显示文件</li><li><strong class=chinese>删除</strong>：删除选中的加密文件</li><li><strong class=chinese>导出</strong>：导出用户的所有数据，用于迁移数据到新设备</li><li><strong class=chinese>导入</strong>：导入用户的所有数据，用于从旧设备迁移数据</li><li><strong class=chinese>锁定</strong>：临时锁定界面，需要输入 2 FA 码解锁</li><li><strong class=chinese>注销</strong>：退出当前用户</li></ul><h3 id=安全建议>安全建议</h3><ul><li>请妥善保管<strong class=chinese>主密钥</strong>和<strong class=chinese>副密钥</strong>，这些密码<strong class=chinese>无法找回</strong></li><li>定期备份加密的文件</li><li>不要在不安全的设备上使用本软件</li><li>建议使用自动生成的强密钥</li></ul><h2 id=软件原理>软件原理</h2><h3 id=底层数据结构>底层数据结构</h3><p>QREcrypt 使用一个主文件夹 (<code>.QREcrypt</code>) 来存储用户的所有数据，并为每个用户维护一个用户主文件夹 (<code>.QREcrypt/用户名</code>)。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>.QREcrypt
</span></span><span class=line><span class=cl>├── 用户名
</span></span><span class=line><span class=cl>│   ├── .用户名_config.enc
</span></span><span class=line><span class=cl>│   ├── 加密文件1.enc
</span></span><span class=line><span class=cl>│   ├── 加密文件2.enc
</span></span><span class=line><span class=cl>│   └── ...
</span></span><span class=line><span class=cl>└── ...
</span></span></code></pre></div><p>每一个用户都拥有一个用户配置文件 (<code>.QREcrypt/用户名/.用户名_config.enc</code>)，其中存放用户的所有数据信息，使用 json 格式。其中<strong class=chinese>主密钥</strong>和<strong class=chinese>副密钥</strong>使用 Bcrypt 哈希，<strong>Google Authenticator 私钥</strong>使用 AES-256 加密，密钥为软件信息+用户信息使用 Argon 2 算法进行密钥派生，<strong class=chinese>文件名称</strong>和<strong class=chinese>文件内容</strong>使用 SHA-256 进行哈希。整个用户配置文件再次使用 XChaCha 20 算法进行加密，密钥为用户主密钥使用 Argon 2 算法进行密钥派生。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>- 用户名
</span></span><span class=line><span class=cl>- 主密钥<span class=o>(</span>Bcrypt<span class=o>)</span>
</span></span><span class=line><span class=cl>- 副密钥<span class=o>(</span>Bcrypt<span class=o>)</span>
</span></span><span class=line><span class=cl>- Google Authenticator私钥<span class=o>(</span>AES-256加密<span class=o>)</span>
</span></span><span class=line><span class=cl>- 文件信息
</span></span><span class=line><span class=cl>  - 文件名称
</span></span><span class=line><span class=cl>  - 文件大小
</span></span><span class=line><span class=cl>  - 原始文件路径
</span></span><span class=line><span class=cl>  - 加密文件路径
</span></span><span class=line><span class=cl>  - 文件加密时间
</span></span><span class=line><span class=cl>  - 文件名称哈希<span class=o>(</span>SHA-256<span class=o>)</span>
</span></span><span class=line><span class=cl>  - 文件内容哈希<span class=o>(</span>SHA-256<span class=o>)</span>
</span></span><span class=line><span class=cl>  - 文件加密算法
</span></span><span class=line><span class=cl>  - 文件加密密钥派生算法
</span></span></code></pre></div><p>用户所有加密的文件是根据用户选择的<strong class=chinese>文件加密算法</strong>进行加密，<strong class=chinese>加密密钥</strong>使用用户<strong class=chinese>副密钥</strong>通过用户选择的<strong class=chinese>密钥派生算法</strong>产生。</p><ul><li>支持的加密算法：<ul><li>QChaCha 20 (推荐)</li><li>XChaCha 20</li><li>ChaCha 20</li><li>AES-256</li><li>QChaCha 12</li><li>QChaCha 8</li></ul></li></ul><blockquote><p>QChaCha 8/12/20 使用 32 字节密钥 12 字节随机数分别采用 64/96/160 字节量子随机数迭代 8/12/20 轮</p><p>XChaCha 20 使用 32 字节密钥 24 字节随机数迭代 20 轮</p><p>ChaCha 20 使用 32 字节密钥 12 字节随机数迭代 20 轮</p><p>AES-256 使用 32 字节密钥 16 字节随机数迭代 14 轮</p></blockquote><ul><li>支持的密钥派生算法：<ul><li>Argon 2 (推荐)</li><li>Scrypt</li><li>PBKDF 2</li></ul></li></ul><blockquote><p>Argon 2 使用 16 字节盐值，迭代 10 次，内存占用 64 MB，线程数 4</p><p>Scrypt 使用 16 字节盐值，CPU 内存成本 32768，块大小 8 (1024 字节) ，线程数 4</p><p>PBKDF 2 使用 16 字节盐值，SHA 3-256 作为伪随机函数，迭代 100000 次</p></blockquote><ul><li>密钥存储算法: Bcrypt</li></ul><blockquote><p>Bcrypt 迭代 12 轮自动生成盐值并验证</p></blockquote><h3 id=运行流程>运行流程</h3><p><strong class=chinese>注册流程</strong>：首先，当用户第一次运行软件时，软件会检查主文件夹是否存在，如果不存在，则创建主文件夹。接着用户进入注册流程，输入用户名和主密钥副密钥 (可使用软件自动生成强密钥)，然后需绑定 2 FA 认证码，软件随机生成一个 Google Authenticator 私钥和二维码，用户使用 2 FA 应用扫描二维码并输入 2 FA 应用显示的 6 位验证码，完成绑定。软件将用户信息进行适当加密写入用户配置文件，并再次加密保存。</p><p><strong class=chinese>登录流程</strong>：用户输入用户名和主密钥，然后输入 2 FA 应用当前显示的 6 位验证码，点击登录用户按钮，软件验证用户名和主密钥，解密并验证 2 FA 验证码，验证成功后，软件显示用户界面。</p><p><strong class=chinese>加密设置流程</strong>：用户点击加密设置按钮，软件弹出加密设置窗口，用户选择加密算法和密钥派生算法，点击保存按钮，软件后续的加密文件行为都将使用这种加密方式。如果用户没有设置加密算法，软件默认使用 QChaCha 20 与 Argon 2 的算法组合，此算法组合拥有理论上最高的加密强度，但需要牺牲一定的加密速度。</p><p><strong class=chinese>文件加密流程</strong>：用户选择需要加密的文件，输入副密钥进行验证，软件根据用户选择的加密算法和密钥派生算法，使用副密钥生成加密密钥，加密文件，同时将加密后的文件移动到用户配置文件中记录的加密文件路径，将所有文件信息写入用户配置文件。</p><p><strong class=chinese>文件解密流程</strong>：用户选择需要解密的文件，输入副密钥进行验证，软件根据用户配置文件中记录的加密算法和密钥派生算法，使用副密钥生成解密密钥，解密文件，这时软件并不会删除该加密文件，用户依然可以重复解密该文件，如果用户想要删除该加密文件，应当手动选择文件列表点击删除按钮，才能将该加密文件删除。</p><p><strong class=chinese>用户数据导出流程</strong>：用户点击导出数据按钮，软件会将用户主文件夹下的所有文件，即用户配置文件和加密后的文件，全部打包成一个 zip 文件，用户可以自行选择保存位置。该功能用于用户更换设备时，将之前的数据导出到新设备中。</p><p><strong class=chinese>用户数据导入流程</strong>：用户点击导入数据按钮，软件会弹出文件选择窗口，用户选择之前导出的 zip 文件，软件会解压文件到主文件夹下的用户名文件夹中，完成导入。该功能默认会覆盖原有的配置和文件，需要主要保存所需文件，以免造成数据丢失。该功能用于用户更换设备时，将之前的数据导入到新设备中。</p><p><strong class=chinese>云端同步流程</strong>：用户可以选择使用软件提供的云端同步功能，将数据同步到云端，用户需要自行准备云端存储服务 (如对象存储，服务器，WebDav 等等)，用户需要先在软件中设置好存储服务，然后点击同步按钮，软件会将用户主文件夹下的所有文件同步到云端，当用户切换新设备时，可以使用云端同步无缝将配置信息同步过来。该功能目前处于测试阶段，可能存在兼容性问题。</p><p><img src=https://image.pi3.fun/blog/image-20241122000531128.png alt=image-20241122000531128></p><h3 id=安全性说明>安全性说明</h3><ol><li>软件中所有的<strong class=chinese>加密算法</strong>和<strong class=chinese>密钥派生算法</strong>都使用了 16 字节完全随机的<strong class=chinese>随机数</strong>和<strong class=chinese>盐值</strong>，所有加密都使用了<strong class=chinese>密钥派生算法</strong>，保证加密的安全性。</li><li>软件中所有文件的加密都遵循<strong class=chinese>一次一密</strong>的原则，使用<strong>副秘钥+盐值</strong>利用密钥派生算法生成完全不同的文件加密密钥。</li><li>软件中的配置信息，尤其是关键的<strong class=chinese>主密钥</strong>和<strong class=chinese>副密钥</strong>都使用了 Bcrypt 哈希，<strong>2 FA 私钥</strong>使用了 AES-256 加密，保证密钥的安全性。整个配置信息使用 XChaCha 20 加密，保证数据的安全性。</li><li>软件中使用了 Google Authenticator 的<strong class=chinese>双重认证机制</strong>，保证账户的安全性。</li><li>软件中所有数据都存储在用户主文件夹中，软件根据用户名自行选择保存位置，软件可以<strong class=chinese>完全离线运行</strong>，可以不将数据上传到任何服务器，也不会在软件中存储用户数据。</li><li>软件使用 GO 语言 <code>-ldflags "-s -w"</code> 选项编译，<strong class=chinese>去除符号表和调试信息</strong>，减少潜在的信息泄漏。使用混淆工具对程序进行<strong class=chinese>混淆</strong>，增加逆向的难度，使用 UPX 进行<strong class=chinese>压缩加壳</strong>，减小程序体积，并增加反调试的难度，防止内存攻击</li><li>软件运行时在内存中存储的敏感数据，只有在需要使用时才解密。在处理完敏感信息后，立即使用<strong class=chinese>零填充</strong>或其他方法<strong class=chinese>清理内存中的数据</strong>，使用 <code>runtime.GC()</code> 强制垃圾回收机制回收内存。软件尽量将敏感数据封装在<strong class=chinese>局部作用域</strong>中。避免<strong class=chinese>硬编码</strong>直接写在程序中。</li></ol><h2 id=常见问题>常见问题</h2><ol><li><p><strong>忘记密码怎么办？</strong></p><ul><li>由于安全原因，密码无法找回。请务必保管好您的密码。</li></ul></li><li><p><strong>如何备份加密文件？</strong></p><ul><li>可以使用工具栏中的导出用户数据功能。</li><li>也可以手动备份 <code>.QREcrypt</code> 文件夹中的所有内容。</li><li>如果配置了云端环境，也可以使用软件的云端同步功能。</li></ul></li><li><p><strong>为什么需要两个密码？</strong></p><ul><li>主密钥用于系统登录，副密钥用于文件加密，这种分离设计提供了更好的安全性。</li></ul></li><li><p><strong>支持加密文件夹吗？</strong></p><ul><li>目前版本仅支持单个文件加密，不支持直接加密文件夹。如果您需要加密文件夹，可以将其打包成 zip 文件后加密。</li></ul></li><li><p><strong>支持批量加解密文件吗？</strong></p><ul><li>目前版本仅支持单个文件加解密，不支持批量加解密文件。</li></ul></li></ol><h2 id=许可证>许可证</h2><p>本项目采用 <a href=LICENSE>MIT 许可证</a>。</p><h2 id=联系方式>联系方式</h2><p>如有问题或建议，请通过以下方式联系：</p><ul><li>项目主页：<a href=https://github.com/Pi3-l22/QREcrypt>GitHub</a></li><li>问题反馈：<a href=https://github.com/Pi3-l22/QREcrypt/issues>Issues</a></li><li>邮箱：<a href=mailto:1310165597@qq.com><a href=mailto:622.511.liuchao@gmail.com>622.511.liuchao@gmail.com</a></a></li></ul></article><div class=paginator><a class=link href=https://blog.pi3.fun/post/2024/go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A815%E6%8C%87%E9%92%88/>← prev</a>
<a></a></div><div class=comment><div id=tcomment></div><script src=https://registry.npmmirror.com/twikoo/1.6.39/files/dist/twikoo.min.js></script><script async>twikoo.init({envId:"https://twikoo.pi3.fun/.netlify/functions/twikoo",el:"#tcomment",lang:"zh-CN"})</script></div></main><footer id=footer><div><span style=display:flex;align-items:center><span style=margin-right:.5rem>© 2021 - 2024</span><img src=https://image.pi3.fun/static/rainbow.gif loading=lazy width=20 alt=rainbow><span style=margin-left:.5rem>By Liu Chao</span></span></div><div class=footnote><span><a class=link href=/index.xml><span class="iconfont icon-RSS"></span></a> | <a class=link href=https://github.com/Pi3-l22 target=_ blank><span class="iconfont icon-GitHub"></span></a> | <a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener><span class="iconfont icon-creative-commons-fill"></span></a></span></div><div class=blog-icon></div></footer></div><script>document.addEventListener("DOMContentLoaded",function(){const n=localStorage.getItem("theme")||"light",e=document.querySelector('link[data-theme-style="light"]'),t=document.querySelector('link[data-theme-style="dark"]'),i=window.matchMedia("(prefers-color-scheme: dark)");i.addListener(function(n){if(!localStorage.getItem("theme")){const s=n.matches?"dark":"light";document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s),s==="light"?(e.media="all",t.media="not all"):(e.media="not all",t.media="all");const o=document.querySelector("iframe.giscus-frame");if(o){const e=s==="light"?"light_tritanopia":"dark_tritanopia";o.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}}}),n==="light"?(e.media="all",t.media="not all"):(e.media="not all",t.media="all");function o(){const e=document.querySelector("iframe.giscus-frame");if(e){const t=n==="light"?"light_tritanopia":"dark_tritanopia";e.contentWindow.postMessage({giscus:{setConfig:{theme:t}}},"https://giscus.app")}else setTimeout(o,1e3)}o();const s=document.querySelector(".theme-toggle");s&&(s.textContent=n==="light"?"黑暗":"明亮",s.addEventListener("click",function(){const o=document.documentElement.getAttribute("data-theme"),n=o==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n),n==="light"?(e.media="all",t.media="not all"):(e.media="not all",t.media="all");const s=document.querySelector("iframe.giscus-frame");if(s){const e=n==="light"?"light_tritanopia":"dark_tritanopia";s.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}this.textContent=n==="light"?"黑暗":"明亮"}))})</script></body></html>